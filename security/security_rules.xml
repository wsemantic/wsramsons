<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Regla de registro mejorada --> 
    <record id="wsramsons_regla_acceso_comercial" model="ir.rule">
        <field name="name">[wsramsons] Contactos: Restricción por comercial</field>
        <field name="model_id" ref="base.model_res_partner"/>
        <field name="domain_force">[('user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('wsramsons.group_comercial'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="False"/>
        <field name="global" eval="False"/>
        <!-- Asegurar que se cree el External ID -->
        <field name="active" eval="True"/>
    </record>

    <!-- Facturas visibles solo para el comercial asignado al cliente -->
    <record id="wsramsons_invoice_salesman_rule" model="ir.rule">
        <field name="name">[wsramsons] Facturas: Restricción por comercial</field>
        <field name="model_id" ref="account.model_account_move"/>
        <field name="domain_force">[('partner_id.user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('wsramsons.group_comercial'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
        <field name="global" eval="False"/>
        <field name="active" eval="True"/>
    </record>
</odoo>
